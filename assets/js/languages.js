// Language data for automatic translation
const LANGUAGE_DATA = {
    en: {
        // HTML lang attribute
        htmlLang: 'en',
        
        // Meta tags
        title: 'Javier Perez - Site Reliability Engineer',
        description: 'I am Javier Perez (Javitech), an expert in DevOps, SRE, and Solution Architect with years of experience in infrastructure optimization and the development of efficient technological solutions. Discover how I can help you transform and scale your business with customized solutions.',
        keywords: 'javier perez devops aws gcp azure sre site reliability engineer certification cloud pipeline infrastructure planning security cost optimization performance automation architect ai dora kubernetes amazon web services docker containers git security ux usability',
        
        // Navigation
        languageButton: '游쀯릖 Espa침ol',
        sayThanks: 'Say thanks 鮫봺잺',
        calendarLabel: "Let's talk",
        
        // Hero section
        heroTitle: 'Javier Perez',
        heroSubtitle: 'Site Reliability Engineer & DevOps Expert',
        
        // About section
        aboutTitle: 'About me',
        aboutText1: 'I help companies and individuals on software architecture solutions taking into account security, scalability, resilience and cost optimization.',
        aboutText2: 'From a young age I\'ve been immersed in technology exploring its inner workings and honing my problem-solving skills. With over 15 years of experience in IT including roles as a DevOps Cloud Engineer and Senior Site Reliability Engineer I\'ve thrived in complex dynamic environments.',
        
        // Interests section
        interestsTitle: 'Interests & Expertise',
        
        // Tags (skills)
        tags: {
            'System Design': 'System Design',
            'AWS': 'AWS',
            'Infrastructure as Code': 'Infrastructure as Code',
            'CI/CD': 'CI/CD',
            'Security': 'Security',
            'User Experience': 'User Experience',
            'Artificial Intelligence': 'Artificial Intelligence'
        },
        
        // Agenda section
        agendaText: 'Stay updated with the latest tech and business events. Follow my curated agenda for industry insights.',
        agendaButton: 'View Event Agenda',
        
        // Contact section
        contactTitle: 'Connect With Me',
        contactText: 'Let\'s collaborate on your next project or discuss the latest in DevOps and SRE practices.',
        
        // Video section
        videoTitle: 'Latest Content',
        videoDescription: 'Check out my latest insights on DevOps, SRE practices, and cloud architecture.',
        
        // Footer
        footerConnect: 'Connect with me',
        footerNewsletter: 'Newsletter',
        footerNewsletterText: 'Subscribe to get the latest updates and news.',
        footerNewsletterPlaceholder: 'Enter your email',
        footerNewsletterButton: 'Subscribe',
        footerContact: 'Contact Me',
        footerContactName: 'Your name',
        footerContactEmail: 'Your email',
        footerContactMessage: 'Your message',
        footerContactButton: 'Send Message',
        
        // Cookie banner
        cookieText: 'This website uses cookies to ensure you get the best experience on our website.',
        cookieLearnMore: 'Learn More',
        cookieAccept: 'Accept',
        cookieDecline: 'Decline',
        
        // Say Thanks page
        sayThanksTitle: 'Say thanks 鮫봺잺',
        sayThanksDescription: 'Support my work in DevOps, SRE, and technology education.',
        homeButton: 'Home'
    },
    
    es: {
        // HTML lang attribute
        htmlLang: 'es',
        
        // Meta tags
        title: 'Javier Perez - Ingeniero de Confiabilidad del Sitio',
        description: 'Soy Javier Perez (Javitech), un experto en DevOps, SRE y Arquitecto de Soluciones con a침os de experiencia en optimizaci칩n de infraestructuras y desarrollo de soluciones tecnol칩gicas eficientes. Descubre c칩mo puedo ayudarte a transformar y escalar tu negocio con soluciones personalizadas.',
        keywords: 'javier perez devops aws gcp azure sre ingeniero de confiabilidad del sitio certificaci칩n nube pipeline infraestructura planificaci칩n seguridad optimizaci칩n de costos rendimiento automatizaci칩n arquitecto ai dora kubernetes servicios web de amazon contenedores docker git seguridad ux usabilidad',
        
        // Navigation
        languageButton: '游쥟릖 English',
        sayThanks: 'Dar gracias 鮫봺잺',
        calendarLabel: 'Agendar reuni칩n',
        
        // Hero section
        heroTitle: 'Javier Perez',
        heroSubtitle: 'Ingeniero de Confiabilidad del Sitio y Experto DevOps',
        
        // About section
        aboutTitle: 'Acerca de m칤',
        aboutText1: 'Ayudo a empresas e individuos en soluciones de arquitectura de software, teniendo en cuenta la seguridad, escalabilidad, resiliencia y optimizaci칩n de costos.',
        aboutText2: 'Desde joven, he estado inmerso en la tecnolog칤a, explorando su funcionamiento interno y perfeccionando mis habilidades para resolver problemas. Con m치s de 15 a침os de experiencia en TI, incluyendo roles como Ingeniero de Nube DevOps y Ingeniero Senior de Confiabilidad del Sitio, he prosperado en entornos complejos y din치micos.',
        
        // Interests section
        interestsTitle: 'Intereses y Experiencia',
        
        // Tags (skills)
        tags: {
            'System Design': 'Dise침o de Sistemas',
            'AWS': 'AWS',
            'Infrastructure as Code': 'Infraestructura como C칩digo',
            'CI/CD': 'CI/CD',
            'Security': 'Seguridad',
            'User Experience': 'Experiencia de Usuario',
            'Artificial Intelligence': 'Inteligencia Artificial'
        },
        
        // Agenda section
        agendaText: 'Mantente actualizado con los 칰ltimos eventos de tecnolog칤a y negocios. Sigue mi agenda curada para obtener informaci칩n de la industria.',
        agendaButton: 'Ver Agenda de Eventos',
        
        // Contact section
        contactTitle: 'Conecta Conmigo',
        contactText: 'Colaboremos en tu pr칩ximo proyecto o discutamos las 칰ltimas pr치cticas de DevOps y SRE.',
        
        // Video section
        videoTitle: 'Contenido M치s Reciente',
        videoDescription: 'Echa un vistazo a mis 칰ltimas ideas sobre DevOps, pr치cticas SRE y arquitectura en la nube.',
        
        // Footer
        footerConnect: 'Conecta conmigo',
        footerNewsletter: 'Bolet칤n',
        footerNewsletterText: 'Suscr칤bete para recibir las 칰ltimas actualizaciones y noticias.',
        footerNewsletterPlaceholder: 'Ingresa tu email',
        footerNewsletterButton: 'Suscribirse',
        footerContact: 'Cont치ctame',
        footerContactName: 'Tu nombre',
        footerContactEmail: 'Tu email',
        footerContactMessage: 'Tu mensaje',
        footerContactButton: 'Enviar Mensaje',
        
        // Cookie banner
        cookieText: 'Este sitio web utiliza cookies para garantizar que obtenga la mejor experiencia en nuestro sitio web.',
        cookieLearnMore: 'Conozca m치s',
        cookieAccept: 'Aceptar',
        cookieDecline: 'Rechazar',
        
        // Say Thanks page
        sayThanksTitle: 'Dar gracias 鮫봺잺',
        sayThanksDescription: 'Apoya mi trabajo en DevOps, SRE y educaci칩n tecnol칩gica.',
        homeButton: 'Inicio'
    }
};

// Language switching functionality
class LanguageSwitcher {
    constructor() {
        this.currentLanguage = this.detectLanguage();
        this.init();
    }
    
    detectLanguage() {
        // Check localStorage first
        const savedLang = localStorage.getItem('preferred-language');
        if (savedLang && LANGUAGE_DATA[savedLang]) {
            return savedLang;
        }
        
        // Check browser language
        const browserLang = navigator.language.split('-')[0];
        if (LANGUAGE_DATA[browserLang]) {
            return browserLang;
        }
        
        // Default to English
        return 'en';
    }
    
    init() {
        this.applyLanguage(this.currentLanguage);
        this.setupLanguageButton();
    }
    
    setupLanguageButton() {
        const languageButton = document.querySelector('.nav-links a[href*="es/"]') || 
                             document.querySelector('.nav-links a:first-child');
        
        if (languageButton) {
            // Remove the href to prevent navigation
            languageButton.removeAttribute('href');
            languageButton.style.cursor = 'pointer';
            
            // Add click event for language switching
            languageButton.addEventListener('click', (e) => {
                e.preventDefault();
                this.toggleLanguage();
            });
        }
    }
    
    toggleLanguage() {
        const newLanguage = this.currentLanguage === 'en' ? 'es' : 'en';
        this.switchLanguage(newLanguage);
    }
    
    switchLanguage(language) {
        if (!LANGUAGE_DATA[language]) {
            console.error('Language not supported:', language);
            return;
        }
        
        this.currentLanguage = language;
        localStorage.setItem('preferred-language', language);
        
        // Apply language with smooth transition
        document.body.style.opacity = '0.7';
        
        setTimeout(() => {
            this.applyLanguage(language);
            document.body.style.opacity = '1';
        }, 150);
        
        console.log('游깷 Language switched to:', language);
    }
    
    applyLanguage(language) {
        const data = LANGUAGE_DATA[language];
        
        // Update HTML lang attribute
        document.documentElement.lang = data.htmlLang;
        
        // Update meta tags
        document.title = data.title;
        this.updateMetaTag('description', data.description);
        this.updateMetaTag('keywords', data.keywords);
        this.updateMetaTag('twitter:title', data.title);
        this.updateMetaTag('twitter:description', data.description);
        this.updateMetaTag('og:title', data.title);
        this.updateMetaTag('og:description', data.description);
        
        // Update navigation
        this.updateElement('.nav-links a:first-child', data.languageButton);
        this.updateElement('.nav-links a[href*="say-thanks"], .nav-links a[href*="dar-gracias"]', data.sayThanks);
        
        // Update Google Calendar button label
        this.updateCalendarButton(data.calendarLabel);
        
        // Update hero section
        this.updateElement('.hero-title, h1', data.heroTitle);
        this.updateElement('.hero-subtitle', data.heroSubtitle);
        
        // Update about section
        this.updateElement('.profile-content h2, section h2', data.aboutTitle, true);
        this.updateElement('.profile-content p:first-of-type', data.aboutText1);
        this.updateElement('.profile-content p:last-of-type', data.aboutText2);
        
        // Update interests section
        this.updateElement('.card h2:first-of-type', `<i class="fas fa-code"></i> ${data.interestsTitle}`);
        
        // Update tags
        this.updateTags(data.tags);
        
        // Update agenda section (if exists)
        const agendaSection = document.querySelector('.card p');
        if (agendaSection && agendaSection.textContent.includes('agenda.javitech.co')) {
            agendaSection.textContent = data.agendaText;
        }
        
        // Update contact section
        this.updateElement('.card h2', `<i class="fas fa-network-wired"></i> ${data.contactTitle}`, false, 1);
        this.updateElement('.card p', data.contactText, false, 1);
        
        // Update video section
        this.updateElement('.card h2', `<i class="fab fa-youtube"></i> ${data.videoTitle}`, false, 2);
        this.updateElement('.card p', data.videoDescription, false, 2);
        
        // Update footer
        this.updateFooter(data);
        
        // Update cookie banner
        this.updateCookieBanner(data);
        
        // Update say-thanks page specific content
        this.updateSayThanksPage(data);
        
        // Update body transition
        document.body.style.transition = 'opacity 0.3s ease';
    }
    
    updateMetaTag(name, content) {
        const selectors = [
            `meta[name="${name}"]`,
            `meta[property="${name}"]`,
            `meta[property="og:${name.replace('og:', '')}"]`,
            `meta[name="twitter:${name.replace('twitter:', '')}"]`
        ];
        
        for (const selector of selectors) {
            const meta = document.querySelector(selector);
            if (meta) {
                meta.setAttribute('content', content);
            }
        }
    }
    
    updateElement(selector, content, isHTML = false, index = 0) {
        const elements = document.querySelectorAll(selector);
        const element = elements[index];
        
        if (element) {
            if (isHTML) {
                element.innerHTML = content;
            } else {
                if (content.includes('<i class=')) {
                    element.innerHTML = content;
                } else {
                    element.textContent = content;
                }
            }
        }
    }
    
    updateTags(tagTranslations) {
        const tags = document.querySelectorAll('.tag');
        tags.forEach(tag => {
            const originalText = tag.textContent.trim();
            if (tagTranslations[originalText]) {
                tag.textContent = tagTranslations[originalText];
            }
        });
    }
    
    updateCalendarButton(label) {
        // Update Google Calendar button when it loads
        const checkCalendarButton = () => {
            const calendarButton = document.querySelector('.calendar-scheduling-button');
            if (calendarButton) {
                calendarButton.textContent = label;
            } else {
                // Try again after a short delay
                setTimeout(checkCalendarButton, 500);
            }
        };
        
        setTimeout(checkCalendarButton, 1000);
    }
    
    updateFooter(data) {
        // Footer headings
        const footerHeadings = document.querySelectorAll('.footer-column h3');
        if (footerHeadings[0]) footerHeadings[0].textContent = data.footerConnect;
        if (footerHeadings[1]) footerHeadings[1].textContent = data.footerNewsletter;
        if (footerHeadings[2]) footerHeadings[2].textContent = data.footerContact;
        
        // Newsletter form
        this.updateElement('.footer-form p', data.footerNewsletterText);
        this.updateElement('#newsletter-email', '', false);
        const newsletterEmail = document.querySelector('#newsletter-email');
        if (newsletterEmail) newsletterEmail.placeholder = data.footerNewsletterPlaceholder;
        this.updateElement('.btn-subscribe', data.footerNewsletterButton);
        
        // Contact form
        const contactName = document.querySelector('#contact-name');
        const contactEmail = document.querySelector('#contact-email');
        const contactMessage = document.querySelector('#contact-message');
        
        if (contactName) contactName.placeholder = data.footerContactName;
        if (contactEmail) contactEmail.placeholder = data.footerContactEmail;
        if (contactMessage) contactMessage.placeholder = data.footerContactMessage;
        this.updateElement('.btn-send', data.footerContactButton);
    }
    
    updateCookieBanner(data) {
        const banner = document.querySelector('#cookieConsentBanner');
        if (banner) {
            const textNode = banner.childNodes[0];
            if (textNode && textNode.nodeType === Node.TEXT_NODE) {
                textNode.textContent = data.cookieText + ' ';
            }
            
            const learnMoreLink = banner.querySelector('a');
            if (learnMoreLink) learnMoreLink.textContent = data.cookieLearnMore;
            
            const buttons = banner.querySelectorAll('button');
            if (buttons[0]) buttons[0].textContent = data.cookieAccept;
            if (buttons[1]) buttons[1].textContent = data.cookieDecline;
        }
    }
    
    updateSayThanksPage(data) {
        // Check if we're on the say-thanks page
        if (window.location.pathname.includes('say-thanks') || 
            document.querySelector('h1')?.textContent.includes('thanks') ||
            document.querySelector('h1')?.textContent.includes('gracias')) {
            
            // Update page title
            if (data.sayThanksTitle) {
                this.updateElement('h1', data.sayThanksTitle);
                document.title = data.sayThanksTitle + ' - Javier Perez';
            }
            
            // Update home button
            const homeButton = document.querySelector('.nav-links a[href*="index"]');
            if (homeButton && data.homeButton) {
                homeButton.innerHTML = `<i class="fas fa-home"></i> ${data.homeButton}`;
            }
            
            // Update meta description for say-thanks page
            if (data.sayThanksDescription) {
                this.updateMetaTag('description', data.sayThanksDescription);
                this.updateMetaTag('twitter:description', data.sayThanksDescription);
                this.updateMetaTag('og:description', data.sayThanksDescription);
            }
        }
    }
    
    // Public method to get current language
    getCurrentLanguage() {
        return this.currentLanguage;
    }
    
    // Public method to switch to specific language
    setLanguage(language) {
        this.switchLanguage(language);
    }
}

// Initialize language switcher when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    window.languageSwitcher = new LanguageSwitcher();
});

// Export for external use
if (typeof module !== 'undefined' && module.exports) {
    module.exports = { LANGUAGE_DATA, LanguageSwitcher };
}
